<svg xmlns="http://www.w3.org/2000/svg" id="mermaid-1583545478146" width="1341.376" height="3738.169" viewBox="0 0 1341.376 3738.169"><style>#mermaid-1583545478146 .label{font-family:&apos;trebuchet ms&apos;,verdana,arial;font-family:var(--mermaid-font-family);color:#333}#mermaid-1583545478146 .node circle,#mermaid-1583545478146 .node path,#mermaid-1583545478146 .node polygon,#mermaid-1583545478146 .node rect{fill:#ececff;stroke:#9370db;stroke-width:1px}#mermaid-1583545478146 .node .label{text-align:center}#mermaid-1583545478146 .arrowheadPath{fill:#333}#mermaid-1583545478146 .edgePath .path{stroke:#333;stroke-width:1.5px}#mermaid-1583545478146 .edgeLabel{background-color:#e8e8e8;text-align:center}#mermaid-1583545478146 .cluster rect{fill:#ffffde;stroke:#aa3;stroke-width:1px}:root{--mermaid-font-family:&apos;&quot;trebuchet ms&quot;, verdana, arial&apos;;--mermaid-font-family:&quot;Comic Sans MS&quot;, &quot;Comic Sans&quot;, cursive;--mermaid-font-family:&quot;trebuchet ms&quot;, verdana, arial}</style><style>#mermaid-1583545478146{color:#000;font:16px &quot;trebuchet ms&quot;,verdana,arial}</style><g><g class="output"><g class="clusters" transform="translate(0, 0)"><g style="opacity:1" id="subGraph3" class="cluster" transform="translate(849.9601593017578,3148.585968017578)"><rect width="966.832" height="957.603" x="-483.416" y="-478.802"/><g id="mermaid-1583545478146Text" class="label"><g transform="translate(0, -464.80157470703125) translate(-94.8671875,-11.875)"><foreignObject width="189.746" height="23.75"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;white-space:nowrap">Run Prompt Validator</div></foreignObject></g></g></g><g style="opacity:1" id="subGraph2" class="cluster" transform="translate(785.2646484375,2295.628921508789)"><rect width="1009.989" height="648.311" x="-504.995" y="-324.155"/><g id="mermaid-1583545478146Text" class="label"><g transform="translate(0, -310.15545654296875) translate(-66.6953125,-11.875)"><foreignObject width="133.398" height="23.75"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;white-space:nowrap">Check Timeout</div></foreignObject></g></g></g><g style="opacity:1" id="subGraph1" class="cluster" transform="translate(599.3431663513184,1021.6195373535156)"><rect width="1182.686" height="1799.708" x="-591.343" y="-899.854"/><g id="mermaid-1583545478146Text" class="label"><g transform="translate(0, -885.8538818359375) translate(-73.6171875,-11.875)"><foreignObject width="147.246" height="23.75"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;white-space:nowrap">Recognize Token</div></foreignObject></g></g></g><g style="opacity:1" id="subGraph0" class="cluster" transform="translate(823.5753936767578,673.5296936035156)"><rect width="441.18" height="187.5" x="-220.59" y="-93.75"/><g id="mermaid-1583545478146Text" class="label"><g transform="translate(0, -79.75) translate(-137.9296875,-11.875)"><foreignObject width="275.859" height="23.75"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;white-space:nowrap">Use Adapter to Get User Token</div></foreignObject></g></g></g></g><g class="edgePaths"><g style="opacity:1" class="edgePath" transform="translate(0, 0)"><path style="fill:none" marker-end="url(#arrowhead868)" d="M709.5597686767578,71.765625L709.5597686767578,96.765625L709.5597686767578,121.765625L710.0597686767578,147.26562805175772" class="path"/><defs><marker id="arrowhead868" markerHeight="6" markerUnits="strokeWidth" markerWidth="8" orient="auto" refX="9" refY="5" viewBox="0 0 10 10"><path style="stroke-width:1;stroke-dasharray:1,0" d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath"/></marker></defs></g><g style="opacity:1" class="edgePath" transform="translate(0, 0)"><path style="fill:none" marker-end="url(#arrowhead869)" d="M611.3589926032647,314.0789144782647L217.9375,449.1546936035156L217.9375,507.9046936035156L217.9375,554.7796936035156L217.9375,579.7796936035156L217.9375,626.6546936035156L217.9375,673.5296936035156L217.9375,720.4046936035156L217.9375,767.2796936035156L217.9375,792.2796936035156L217.9375,1004.2828216552734L217.9375,1228.1609497070312L217.9375,1475.1296997070312L217.9375,1722.0984497070312L217.9375,1758.9734497070312" class="path"/><defs><marker id="arrowhead869" markerHeight="6" markerUnits="strokeWidth" markerWidth="8" orient="auto" refX="9" refY="5" viewBox="0 0 10 10"><path style="stroke-width:1;stroke-dasharray:1,0" d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath"/></marker></defs></g><g style="opacity:1" class="edgePath" transform="translate(0, 0)"><path style="fill:none" marker-end="url(#arrowhead870)" d="M710.0597686767578,412.7796844482422L709.5597686767578,449.1546936035156L709.5597686767578,507.9046936035156L709.5597686767578,554.7796936035156L709.5597686767578,579.7796936035156L773.0347686767578,604.7796936035156" class="path"/><defs><marker id="arrowhead870" markerHeight="6" markerUnits="strokeWidth" markerWidth="8" orient="auto" refX="9" refY="5" viewBox="0 0 10 10"><path style="stroke-width:1;stroke-dasharray:1,0" d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath"/></marker></defs></g><g style="opacity:1" class="edgePath" transform="translate(0, 0)"><path style="fill:none" marker-end="url(#arrowhead871)" d="M787.5755074218446,335.26394570315534L947.5910186767578,449.1546936035156L947.5910186767578,486.0296936035156" class="path"/><defs><marker id="arrowhead871" markerHeight="6" markerUnits="strokeWidth" markerWidth="8" orient="auto" refX="9" refY="5" viewBox="0 0 10 10"><path style="stroke-width:1;stroke-dasharray:1,0" d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath"/></marker></defs></g><g style="opacity:1" class="edgePath" transform="translate(0, 0)"><path style="fill:none" marker-end="url(#arrowhead872)" d="M947.5910186767578,529.7796936035156L947.5910186767578,554.7796936035156L947.5910186767578,579.7796936035156L884.1160186767578,604.7796936035156" class="path"/><defs><marker id="arrowhead872" markerHeight="6" markerUnits="strokeWidth" markerWidth="8" orient="auto" refX="9" refY="5" viewBox="0 0 10 10"><path style="stroke-width:1;stroke-dasharray:1,0" d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath"/></marker></defs></g><g style="opacity:1" class="edgePath" transform="translate(0, 0)"><path style="fill:none" marker-end="url(#arrowhead873)" d="M828.5753936767578,648.5296936035156L828.5753936767578,673.5296936035156L828.5753936767578,698.5296936035156" class="path"/><defs><marker id="arrowhead873" markerHeight="6" markerUnits="strokeWidth" markerWidth="8" orient="auto" refX="9" refY="5" viewBox="0 0 10 10"><path style="stroke-width:1;stroke-dasharray:1,0" d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath"/></marker></defs></g><g style="opacity:1" class="edgePath" transform="translate(0, 0)"><path style="fill:none" marker-end="url(#arrowhead874)" d="M828.5753936767578,742.2796936035156L828.5753936767578,767.2796936035156L828.5753936767578,792.2796936035156L829.0753936767578,817.7796966552736" class="path"/><defs><marker id="arrowhead874" markerHeight="6" markerUnits="strokeWidth" markerWidth="8" orient="auto" refX="9" refY="5" viewBox="0 0 10 10"><path style="stroke-width:1;stroke-dasharray:1,0" d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath"/></marker></defs></g><g style="opacity:1" class="edgePath" transform="translate(0, 0)"><path style="fill:none" marker-end="url(#arrowhead875)" d="M762.9235617301459,1125.6341147086616L706.0285186767578,1228.1609497070312L706.5285186767578,1265.5359497070312" class="path"/><defs><marker id="arrowhead875" markerHeight="6" markerUnits="strokeWidth" markerWidth="8" orient="auto" refX="9" refY="5" viewBox="0 0 10 10"><path style="stroke-width:1;stroke-dasharray:1,0" d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath"/></marker></defs></g><g style="opacity:1" class="edgePath" transform="translate(0, 0)"><path style="fill:none" marker-end="url(#arrowhead876)" d="M636.9844102409077,1616.179341271181L583.828125,1722.0984497070312L583.828125,1758.9734497070312" class="path"/><defs><marker id="arrowhead876" markerHeight="6" markerUnits="strokeWidth" markerWidth="8" orient="auto" refX="9" refY="5" viewBox="0 0 10 10"><path style="stroke-width:1;stroke-dasharray:1,0" d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath"/></marker></defs></g><g style="opacity:1" class="edgePath" transform="translate(0, 0)"><path style="fill:none" marker-end="url(#arrowhead877)" d="M794.7274167098496,1597.5245516739394L884.7265625,1722.0984497070312L884.7265625,1758.9734497070312" class="path"/><defs><marker id="arrowhead877" markerHeight="6" markerUnits="strokeWidth" markerWidth="8" orient="auto" refX="9" refY="5" viewBox="0 0 10 10"><path style="stroke-width:1;stroke-dasharray:1,0" d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath"/></marker></defs></g><g style="opacity:1" class="edgePath" transform="translate(0, 0)"><path style="fill:none" marker-end="url(#arrowhead878)" d="M924.610035401318,1096.251298827198L1062.405860900879,1228.1609497070312L1062.405860900879,1475.1296997070312L1062.405860900879,1722.0984497070312L1062.405860900879,1780.8484497070312L1062.405860900879,1827.7234497070312L879.33984375,1853.875457549744" class="path"/><defs><marker id="arrowhead878" markerHeight="6" markerUnits="strokeWidth" markerWidth="8" orient="auto" refX="9" refY="5" viewBox="0 0 10 10"><path style="stroke-width:1;stroke-dasharray:1,0" d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath"/></marker></defs></g><g style="opacity:1" class="edgePath" transform="translate(0, 0)"><path style="fill:none" marker-end="url(#arrowhead879)" d="M217.9375,1802.7234497070312L217.9375,1827.7234497070312L589.21484375,1861.429207066147" class="path"/><defs><marker id="arrowhead879" markerHeight="6" markerUnits="strokeWidth" markerWidth="8" orient="auto" refX="9" refY="5" viewBox="0 0 10 10"><path style="stroke-width:1;stroke-dasharray:1,0" d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath"/></marker></defs></g><g style="opacity:1" class="edgePath" transform="translate(0, 0)"><path style="fill:none" marker-end="url(#arrowhead880)" d="M583.828125,1802.7234497070312L583.828125,1827.7234497070312L664.0677083333334,1852.7234497070312" class="path"/><defs><marker id="arrowhead880" markerHeight="6" markerUnits="strokeWidth" markerWidth="8" orient="auto" refX="9" refY="5" viewBox="0 0 10 10"><path style="stroke-width:1;stroke-dasharray:1,0" d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath"/></marker></defs></g><g style="opacity:1" class="edgePath" transform="translate(0, 0)"><path style="fill:none" marker-end="url(#arrowhead881)" d="M884.7265625,1802.7234497070312L884.7265625,1827.7234497070312L804.4869791666666,1852.7234497070312" class="path"/><defs><marker id="arrowhead881" markerHeight="6" markerUnits="strokeWidth" markerWidth="8" orient="auto" refX="9" refY="5" viewBox="0 0 10 10"><path style="stroke-width:1;stroke-dasharray:1,0" d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath"/></marker></defs></g><g style="opacity:1" class="edgePath" transform="translate(0, 0)"><path style="fill:none" marker-end="url(#arrowhead882)" d="M734.27734375,1896.4734497070312L734.27734375,1921.4734497070312L734.27734375,1946.4734497070312L734.27734375,1971.4734497070312L734.7773437500001,1996.97345275879" class="path"/><defs><marker id="arrowhead882" markerHeight="6" markerUnits="strokeWidth" markerWidth="8" orient="auto" refX="9" refY="5" viewBox="0 0 10 10"><path style="stroke-width:1;stroke-dasharray:1,0" d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath"/></marker></defs></g><g style="opacity:1" class="edgePath" transform="translate(0, 0)"><path style="fill:none" marker-end="url(#arrowhead883)" d="M617.0082012525171,2360.0152477613055L468.0015640258789,2514.159393310547L468.0015640258789,2551.034393310547" class="path"/><defs><marker id="arrowhead883" markerHeight="6" markerUnits="strokeWidth" markerWidth="8" orient="auto" refX="9" refY="5" viewBox="0 0 10 10"><path style="stroke-width:1;stroke-dasharray:1,0" d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath"/></marker></defs></g><g style="opacity:1" class="edgePath" transform="translate(0, 0)"><path style="fill:none" marker-end="url(#arrowhead884)" d="M838.9461602453837,2373.615567659889L946.2906265258789,2514.159393310547L946.2906265258789,2551.034393310547" class="path"/><defs><marker id="arrowhead884" markerHeight="6" markerUnits="strokeWidth" markerWidth="8" orient="auto" refX="9" refY="5" viewBox="0 0 10 10"><path style="stroke-width:1;stroke-dasharray:1,0" d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath"/></marker></defs></g><g style="opacity:1" class="edgePath" transform="translate(0, 0)"><path style="fill:none" marker-end="url(#arrowhead885)" d="M946.2906265258789,2594.784393310547L946.2906265258789,2619.784393310547L946.2906265258789,2644.784393310547L946.2906265258789,2669.784393310547L946.2906265258789,2694.784393310547" class="path"/><defs><marker id="arrowhead885" markerHeight="6" markerUnits="strokeWidth" markerWidth="8" orient="auto" refX="9" refY="5" viewBox="0 0 10 10"><path style="stroke-width:1;stroke-dasharray:1,0" d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath"/></marker></defs></g><g style="opacity:1" class="edgePath" transform="translate(0, 0)"><path style="fill:none" marker-end="url(#arrowhead886)" d="M946.2906265258789,2738.534393310547L946.2906265258789,2763.534393310547L946.7906265258774,2789.0343994140608" class="path"/><defs><marker id="arrowhead886" markerHeight="6" markerUnits="strokeWidth" markerWidth="8" orient="auto" refX="9" refY="5" viewBox="0 0 10 10"><path style="stroke-width:1;stroke-dasharray:1,0" d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath"/></marker></defs></g><g style="opacity:1" class="edgePath" transform="translate(0, 0)"><path style="fill:none" marker-end="url(#arrowhead887)" d="M852.5374269049174,2992.442137293101L625.5832061767578,3123.070343017578L625.5832061767578,3322.4164428710938L625.5832061767578,3521.7625427246094L625.5832061767578,3558.6375427246094" class="path"/><defs><marker id="arrowhead887" markerHeight="6" markerUnits="strokeWidth" markerWidth="8" orient="auto" refX="9" refY="5" viewBox="0 0 10 10"><path style="stroke-width:1;stroke-dasharray:1,0" d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath"/></marker></defs></g><g style="opacity:1" class="edgePath" transform="translate(0, 0)"><path style="fill:none" marker-end="url(#arrowhead888)" d="M999.6451568136663,3033.8407944192427L1048.5597686767578,3123.070343017578L1049.0597686767578,3160.4453491210934" class="path"/><defs><marker id="arrowhead888" markerHeight="6" markerUnits="strokeWidth" markerWidth="8" orient="auto" refX="9" refY="5" viewBox="0 0 10 10"><path style="stroke-width:1;stroke-dasharray:1,0" d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath"/></marker></defs></g><g style="opacity:1" class="edgePath" transform="translate(0, 0)"><path style="fill:none" marker-end="url(#arrowhead889)" d="M996.4706789009192,3432.7984468452555L953.1535186767578,3521.7625427246094L953.1535186767578,3558.6375427246094" class="path"/><defs><marker id="arrowhead889" markerHeight="6" markerUnits="strokeWidth" markerWidth="8" orient="auto" refX="9" refY="5" viewBox="0 0 10 10"><path style="stroke-width:1;stroke-dasharray:1,0" d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath"/></marker></defs></g><g style="opacity:1" class="edgePath" transform="translate(0, 0)"><path style="fill:none" marker-end="url(#arrowhead890)" d="M1101.6488545013915,3432.7984385894297L1143.9660186767578,3521.7625427246094L1143.9660186767578,3558.6375427246094" class="path"/><defs><marker id="arrowhead890" markerHeight="6" markerUnits="strokeWidth" markerWidth="8" orient="auto" refX="9" refY="5" viewBox="0 0 10 10"><path style="stroke-width:1;stroke-dasharray:1,0" d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath"/></marker></defs></g><g style="opacity:1" class="edgePath" transform="translate(0, 0)"><path style="fill:none" marker-end="url(#arrowhead891)" d="M625.5832061767578,3602.3875427246094L625.5832061767578,3627.3875427246094L625.5832061767578,3652.3875427246094L858.887913241941,3698.645537482187" class="path"/><defs><marker id="arrowhead891" markerHeight="6" markerUnits="strokeWidth" markerWidth="8" orient="auto" refX="9" refY="5" viewBox="0 0 10 10"><path style="stroke-width:1;stroke-dasharray:1,0" d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath"/></marker></defs></g><g style="opacity:1" class="edgePath" transform="translate(0, 0)"><path style="fill:none" marker-end="url(#arrowhead892)" d="M953.1535186767578,3602.3875427246094L953.1535186767578,3627.3875427246094L953.1535186767578,3652.3875427246094L905.8713381727609,3687.922782182512" class="path"/><defs><marker id="arrowhead892" markerHeight="6" markerUnits="strokeWidth" markerWidth="8" orient="auto" refX="9" refY="5" viewBox="0 0 10 10"><path style="stroke-width:1;stroke-dasharray:1,0" d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath"/></marker></defs></g><g style="opacity:1" class="edgePath" transform="translate(0, 0)"><path style="fill:none" marker-end="url(#arrowhead893)" d="M1143.9660186767578,3602.3875427246094L1143.9660186767578,3627.3875427246094L1143.9660186767578,3652.3875427246094L910.6613116115747,3698.645537482187" class="path"/><defs><marker id="arrowhead893" markerHeight="6" markerUnits="strokeWidth" markerWidth="8" orient="auto" refX="9" refY="5" viewBox="0 0 10 10"><path style="stroke-width:1;stroke-dasharray:1,0" d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath"/></marker></defs></g></g><g class="edgeLabels"><g style="opacity:1" class="edgeLabel"><g class="label" transform="translate(0, 0) translate(0,0)"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;white-space:nowrap"><span class="edgeLabel"/></div></foreignObject></g></g><g style="opacity:1" class="edgeLabel"><g class="label" transform="translate(0, 0) translate(217.9375,720.4046936035156) translate(-97.8671875,-11.875)"><foreignObject width="195.742" height="23.75"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;white-space:nowrap"><span class="edgeLabel">Token Response Event</span></div></foreignObject></g></g><g style="opacity:1" class="edgeLabel"><g class="label" transform="translate(0, 0) translate(709.5597686767578,507.9046936035156) translate(-59.6328125,-11.875)"><foreignObject width="119.277" height="23.75"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;white-space:nowrap"><span class="edgeLabel">Teams Invoke</span></div></foreignObject></g></g><g style="opacity:1" class="edgeLabel"><g class="label" transform="translate(0, 0) translate(947.5910186767578,449.1546936035156) translate(-36.375,-11.875)"><foreignObject width="72.754" height="23.75"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;white-space:nowrap"><span class="edgeLabel">Message</span></div></foreignObject></g></g><g style="opacity:1" class="edgeLabel"><g class="label" transform="translate(0, 0) translate(0,0)"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;white-space:nowrap"><span class="edgeLabel"/></div></foreignObject></g></g><g style="opacity:1" class="edgeLabel"><g class="label" transform="translate(0, 0) translate(0,0)"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;white-space:nowrap"><span class="edgeLabel"/></div></foreignObject></g></g><g style="opacity:1" class="edgeLabel"><g class="label" transform="translate(0, 0) translate(0,0)"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;white-space:nowrap"><span class="edgeLabel"/></div></foreignObject></g></g><g style="opacity:1" class="edgeLabel"><g class="label" transform="translate(0, 0) translate(706.0285186767578,1228.1609497070312) translate(-27.6171875,-11.875)"><foreignObject width="55.234" height="23.75"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;white-space:nowrap"><span class="edgeLabel">Teams</span></div></foreignObject></g></g><g style="opacity:1" class="edgeLabel"><g class="label" transform="translate(0, 0) translate(583.828125,1722.0984497070312) translate(-11.7421875,-11.875)"><foreignObject width="23.496" height="23.75"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;white-space:nowrap"><span class="edgeLabel">No</span></div></foreignObject></g></g><g style="opacity:1" class="edgeLabel"><g class="label" transform="translate(0, 0) translate(884.7265625,1722.0984497070312) translate(-14.15625,-11.875)"><foreignObject width="28.32" height="23.75"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;white-space:nowrap"><span class="edgeLabel">Yes</span></div></foreignObject></g></g><g style="opacity:1" class="edgeLabel"><g class="label" transform="translate(0, 0) translate(1062.405860900879,1722.0984497070312) translate(-36.375,-11.875)"><foreignObject width="72.754" height="23.75"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;white-space:nowrap"><span class="edgeLabel">Message</span></div></foreignObject></g></g><g style="opacity:1" class="edgeLabel"><g class="label" transform="translate(0, 0) translate(0,0)"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;white-space:nowrap"><span class="edgeLabel"/></div></foreignObject></g></g><g style="opacity:1" class="edgeLabel"><g class="label" transform="translate(0, 0) translate(0,0)"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;white-space:nowrap"><span class="edgeLabel"/></div></foreignObject></g></g><g style="opacity:1" class="edgeLabel"><g class="label" transform="translate(0, 0) translate(0,0)"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;white-space:nowrap"><span class="edgeLabel"/></div></foreignObject></g></g><g style="opacity:1" class="edgeLabel"><g class="label" transform="translate(0, 0) translate(0,0)"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;white-space:nowrap"><span class="edgeLabel"/></div></foreignObject></g></g><g style="opacity:1" class="edgeLabel"><g class="label" transform="translate(0, 0) translate(468.0015640258789,2514.159393310547) translate(-14.15625,-11.875)"><foreignObject width="28.32" height="23.75"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;white-space:nowrap"><span class="edgeLabel">Yes</span></div></foreignObject></g></g><g style="opacity:1" class="edgeLabel"><g class="label" transform="translate(0, 0) translate(946.2906265258789,2514.159393310547) translate(-11.7421875,-11.875)"><foreignObject width="23.496" height="23.75"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;white-space:nowrap"><span class="edgeLabel">No</span></div></foreignObject></g></g><g style="opacity:1" class="edgeLabel"><g class="label" transform="translate(0, 0) translate(0,0)"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;white-space:nowrap"><span class="edgeLabel"/></div></foreignObject></g></g><g style="opacity:1" class="edgeLabel"><g class="label" transform="translate(0, 0) translate(0,0)"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;white-space:nowrap"><span class="edgeLabel"/></div></foreignObject></g></g><g style="opacity:1" class="edgeLabel"><g class="label" transform="translate(0, 0) translate(625.5832061767578,3322.4164428710938) translate(-14.15625,-11.875)"><foreignObject width="28.32" height="23.75"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;white-space:nowrap"><span class="edgeLabel">Yes</span></div></foreignObject></g></g><g style="opacity:1" class="edgeLabel"><g class="label" transform="translate(0, 0) translate(1048.5597686767578,3123.070343017578) translate(-11.7421875,-11.875)"><foreignObject width="23.496" height="23.75"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;white-space:nowrap"><span class="edgeLabel">No</span></div></foreignObject></g></g><g style="opacity:1" class="edgeLabel"><g class="label" transform="translate(0, 0) translate(953.1535186767578,3521.7625427246094) translate(-14.15625,-11.875)"><foreignObject width="28.32" height="23.75"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;white-space:nowrap"><span class="edgeLabel">Yes</span></div></foreignObject></g></g><g style="opacity:1" class="edgeLabel"><g class="label" transform="translate(0, 0) translate(1143.9660186767578,3521.7625427246094) translate(-11.7421875,-11.875)"><foreignObject width="23.496" height="23.75"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;white-space:nowrap"><span class="edgeLabel">No</span></div></foreignObject></g></g><g style="opacity:1" class="edgeLabel"><g class="label" transform="translate(0, 0) translate(0,0)"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;white-space:nowrap"><span class="edgeLabel"/></div></foreignObject></g></g><g style="opacity:1" class="edgeLabel"><g class="label" transform="translate(0, 0) translate(0,0)"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;white-space:nowrap"><span class="edgeLabel"/></div></foreignObject></g></g><g style="opacity:1" class="edgeLabel"><g class="label" transform="translate(0, 0) translate(0,0)"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;white-space:nowrap"><span class="edgeLabel"/></div></foreignObject></g></g></g><g class="nodes" transform="translate(0, 0)"><g style="opacity:1" id="Validate" class="node" transform="translate(946.2906265258789,2716.659393310547)"><rect width="443.078" height="43.75" x="-221.539" y="-21.875" class="label-container" rx="0" ry="0"/><g class="label"><g transform="translate(0,0) translate(-211.5390625,-11.875)"><foreignObject width="423.086" height="23.75"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;white-space:nowrap">Validate value from RecognizeToken operations</div></foreignObject></g></g></g><g style="opacity:1" id="State" class="node" transform="translate(946.2906265258789,2572.909393310547)"><rect width="617.938" height="43.75" x="-308.969" y="-21.875" class="label-container" rx="0" ry="0"/><g class="label"><g transform="translate(0,0) translate(-298.96875,-11.875)"><foreignObject width="597.949" height="23.75"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;white-space:nowrap">Grab persisted state and options, and increment attempt count +1</div></foreignObject></g></g></g><g style="opacity:1" id="IsValid" class="node" transform="translate(946.2906265258789,2937.3648681640625)"><polygon points="148.83 0 297.661 -148.83 148.83 -297.661 0 -148.83" class="label-container" transform="translate(-148.83046875,148.83046875)"/><g class="label"><g transform="translate(0,0) translate(-133.4921875,-11.875)"><foreignObject width="266.992" height="23.75"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;white-space:nowrap">Is the recognized result valid?</div></foreignObject></g></g></g><g style="opacity:1" id="EndDialogReturningValue" class="node" transform="translate(625.5832061767578,3580.5125427246094)"><rect width="448.078" height="43.75" x="-224.039" y="-21.875" class="label-container" rx="0" ry="0"/><g class="label"><g transform="translate(0,0) translate(-214.0390625,-11.875)"><foreignObject width="428.086" height="23.75"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;white-space:nowrap">EndDialog returning the recognized Token value</div></foreignObject></g></g></g><g style="opacity:1" id="HasReprompt" class="node" transform="translate(1048.5597686767578,3322.4164428710938)"><polygon points="162.471 0 324.942 -162.471 162.471 -324.942 0 -162.471" class="label-container" transform="translate(-162.47109375,162.47109375)"/><g class="label"><g transform="translate(0,0) translate(-148.6484375,-11.875)"><foreignObject width="297.305" height="23.75"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;white-space:nowrap">Do we have a Reprompt fallback?</div></foreignObject></g></g></g><g style="opacity:1" id="Reprompt" class="node" transform="translate(953.1535186767578,3580.5125427246094)"><rect width="107.063" height="43.75" x="-53.531" y="-21.875" class="label-container" rx="0" ry="0"/><g class="label"><g transform="translate(0,0) translate(-43.53125,-11.875)"><foreignObject width="87.07" height="23.75"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;white-space:nowrap">Reprompt</div></foreignObject></g></g></g><g style="opacity:1" id="EndOfTurn" class="node" transform="translate(1143.9660186767578,3580.5125427246094)"><rect width="174.563" height="43.75" x="-87.281" y="-21.875" class="label-container" rx="0" ry="0"/><g class="label"><g transform="translate(0,0) translate(-77.28125,-11.875)"><foreignObject width="154.57" height="23.75"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;white-space:nowrap">return EndOfTurn</div></foreignObject></g></g></g><g style="opacity:1" id="EndDialogNoResult" class="node" transform="translate(468.0015640258789,2572.909393310547)"><rect width="238.641" height="43.75" x="-119.32" y="-21.875" class="label-container" rx="0" ry="0"/><g class="label"><g transform="translate(0,0) translate(-109.3203125,-11.875)"><foreignObject width="218.652" height="23.75"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;white-space:nowrap">EndDialog with no result</div></foreignObject></g></g></g><g style="opacity:1" id="Timeout" class="node" transform="translate(734.27734375,2236.878921508789)"><polygon points="240.405 0 480.811 -240.405 240.405 -480.811 0 -240.405" class="label-container" transform="translate(-240.40546875,240.40546875)"/><g class="label"><g transform="translate(0,0) translate(-235.2421875,-11.875)"><foreignObject width="470.488" height="23.75"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;white-space:nowrap">Have we timed out waiting for user to authenticate?</div></foreignObject></g></g></g><g style="opacity:1" id="TokenResponseActivity" class="node" transform="translate(217.9375,1780.8484497070312)"><rect width="349.875" height="43.75" x="-174.938" y="-21.875" class="label-container" rx="0" ry="0"/><g class="label"><g transform="translate(0,0) translate(-164.9375,-11.875)"><foreignObject width="329.883" height="23.75"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;white-space:nowrap">Parse token values from TurnContext</div></foreignObject></g></g></g><g style="opacity:1" id="ResponseType" class="node" transform="translate(709.5597686767578,279.5226593017578)"><polygon points="132.757 0 265.514 -132.757 132.757 -265.514 0 -132.757" class="label-container" transform="translate(-132.75703125,132.75703125)"/><g class="label"><g transform="translate(0,0) translate(-115.6328125,-11.875)"><foreignObject width="231.27" height="23.75"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;white-space:nowrap">What Type is the Activity?</div></foreignObject></g></g></g><g style="opacity:1" id="CreateOAuthClient" class="node" transform="translate(828.5753936767578,626.6546936035156)"><rect width="194.406" height="43.75" x="-97.203" y="-21.875" class="label-container" rx="0" ry="0"/><g class="label"><g transform="translate(0,0) translate(-87.203125,-11.875)"><foreignObject width="174.414" height="23.75"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;white-space:nowrap">Create OAuthClient</div></foreignObject></g></g></g><g style="opacity:1" id="MagicCode" class="node" transform="translate(947.5910186767578,507.9046936035156)"><rect width="286.797" height="43.75" x="-143.398" y="-21.875" class="label-container" rx="0" ry="0"/><g class="label"><g transform="translate(0,0) translate(-133.3984375,-11.875)"><foreignObject width="266.797" height="23.75"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;white-space:nowrap">Get Magic Code from Message</div></foreignObject></g></g></g><g style="opacity:1" id="TeamsOrMessage" class="node" transform="translate(828.5753936767578,1004.2828216552734)"><polygon points="187.003 0 374.006 -187.003 187.003 -374.006 0 -187.003" class="label-container" transform="translate(-187.003125,187.003125)"/><g class="label"><g transform="translate(0,0) translate(-175.90625,-11.875)"><foreignObject width="351.816" height="23.75"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;white-space:nowrap">Teams Invoke or Message Activity Type?</div></foreignObject></g></g></g><g style="opacity:1" id="GetUserTokenAsync" class="node" transform="translate(828.5753936767578,720.4046936035156)"><rect width="276.297" height="43.75" x="-138.148" y="-21.875" class="label-container" rx="0" ry="0"/><g class="label"><g transform="translate(0,0) translate(-128.1484375,-11.875)"><foreignObject width="256.309" height="23.75"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;white-space:nowrap">Get Token using OAuthClient</div></foreignObject></g></g></g><g style="opacity:1" id="TeamsGotTokenCheck" class="node" transform="translate(706.0285186767578,1475.1296997070312)"><polygon points="210.094 0 420.188 -210.094 210.094 -420.188 0 -210.094" class="label-container" transform="translate(-210.09375,210.09375)"/><g class="label"><g transform="translate(0,0) translate(-201.5625,-11.875)"><foreignObject width="403.125" height="23.75"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;white-space:nowrap">Did adapter successfully get token from ABS?</div></foreignObject></g></g></g><g style="opacity:1" id="TeamsError" class="node" transform="translate(583.828125,1780.8484497070312)"><rect width="281.906" height="43.75" x="-140.953" y="-21.875" class="label-container" rx="0" ry="0"/><g class="label"><g transform="translate(0,0) translate(-130.953125,-11.875)"><foreignObject width="261.914" height="23.75"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;white-space:nowrap">Bot Adapter sends 404 or 500</div></foreignObject></g></g></g><g style="opacity:1" id="TeamsSuccess" class="node" transform="translate(884.7265625,1780.8484497070312)"><rect width="219.891" height="43.75" x="-109.945" y="-21.875" class="label-container" rx="0" ry="0"/><g class="label"><g transform="translate(0,0) translate(-99.9453125,-11.875)"><foreignObject width="199.902" height="23.75"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;white-space:nowrap">Bot Adapter sends 200</div></foreignObject></g></g></g><g style="opacity:1" id="ReturnRecognizeTokenResult" class="node" transform="translate(734.27734375,1874.5984497070312)"><rect width="290.125" height="43.75" x="-145.063" y="-21.875" class="label-container" rx="0" ry="0"/><g class="label"><g transform="translate(0,0) translate(-135.0625,-11.875)"><foreignObject width="270.137" height="23.75"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;white-space:nowrap">Return Recognize Token result</div></foreignObject></g></g></g><g style="opacity:1" id="Start" class="node" transform="translate(709.5597686767578,39.8828125)"><circle x="-31.883" y="-21.875" r="31.883" class="label-container"/><g class="label"><g transform="translate(0,0) translate(-21.8828125,-11.875)"><foreignObject width="43.77" height="23.75"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;white-space:nowrap">Start</div></foreignObject></g></g></g><g style="opacity:1" id="End" class="node" transform="translate(884.7746124267578,3703.7781677246094)"><circle x="-26.391" y="-21.875" r="26.391" class="label-container"/><g class="label"><g transform="translate(0,0) translate(-16.390625,-11.875)"><foreignObject width="32.793" height="23.75"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;white-space:nowrap">End</div></foreignObject></g></g></g></g></g></g></svg>