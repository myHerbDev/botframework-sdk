<svg xmlns="http://www.w3.org/2000/svg" id="mermaid-1583540295089" width="1544.828" height="282.875" viewBox="0 0 1544.828 282.875"><style>#mermaid-1583540295089 .label{font-family:&apos;trebuchet ms&apos;,verdana,arial;font-family:var(--mermaid-font-family);color:#333}#mermaid-1583540295089 .node path,#mermaid-1583540295089 .node polygon,#mermaid-1583540295089 .node rect{fill:#ececff;stroke:#9370db;stroke-width:1px}#mermaid-1583540295089 .node .label{text-align:center}#mermaid-1583540295089 .edgePath .path{stroke:#333;stroke-width:1.5px}#mermaid-1583540295089 .edgeLabel{background-color:#e8e8e8;text-align:center}#mermaid-1583540295089 .cluster rect{fill:#ffffde;stroke:#aa3;stroke-width:1px}:root{--mermaid-font-family:&apos;&quot;trebuchet ms&quot;, verdana, arial&apos;;--mermaid-font-family:&quot;Comic Sans MS&quot;, &quot;Comic Sans&quot;, cursive;--mermaid-font-family:&quot;trebuchet ms&quot;, verdana, arial}</style><style>#mermaid-1583540295089{color:#000;font:16px &quot;trebuchet ms&quot;,verdana,arial}</style><g><g class="output"><g class="clusters" transform="translate(0, 0)"><g style="opacity:1" id="subGraph1" class="cluster" transform="translate(805.9609375,74.5625)"><rect width="1261.797" height="133.125" x="-630.898" y="-66.563"/><g id="mermaid-1583540295089Text" class="label"><g transform="translate(0, -52.5625) translate(-117.1171875,-11.875)"><foreignObject width="234.238" height="23.75"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;white-space:nowrap">Bot to Protected Resource</div></foreignObject></g></g></g><g style="opacity:1" id="subGraph0" class="cluster" transform="translate(242.1328125,218)"><rect width="468.266" height="113.75" x="-234.133" y="-56.875"/><g id="mermaid-1583540295089Text" class="label"><g transform="translate(0, -42.875) translate(-100.0546875,-11.875)"><foreignObject width="200.117" height="23.75"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;white-space:nowrap">Channel-to-Bot Access</div></foreignObject></g></g></g></g><g class="edgePaths"><g style="opacity:1" class="edgePath" transform="translate(0, 0)"><path style="fill:none" marker-end="url(#arrowhead420)" d="M125.0625,218L150.0625,218L175.0625,218L203.734375,218" class="path"/><defs><marker id="arrowhead420" markerHeight="6" markerUnits="strokeWidth" markerWidth="8" orient="auto" refX="9" refY="5" viewBox="0 0 10 10"><path style="fill:#333" d="M 0 0 L 0 0 L 0 0 z"/></marker></defs></g><g style="opacity:1" class="edgePath" transform="translate(0, 0)"><path style="fill:none" marker-end="url(#arrowhead421)" d="M447.59375,218L476.265625,218L819.4296875,218L1162.59375,218" class="path"/><defs><marker id="arrowhead421" markerHeight="6" markerUnits="strokeWidth" markerWidth="8" orient="auto" refX="9" refY="5" viewBox="0 0 10 10"><path style="fill:#333" d="M 0 0 L 0 0 L 0 0 z"/></marker></defs></g><g style="opacity:1" class="edgePath" transform="translate(0, 0)"><path style="fill:none" marker-end="url(#arrowhead422)" d="M451.265625,67.52063988172434L476.265625,64.875L819.4296875,64.875L1180.015625,65.375" class="path"/><defs><marker id="arrowhead422" markerHeight="6" markerUnits="strokeWidth" markerWidth="8" orient="auto" refX="9" refY="5" viewBox="0 0 10 10"><path style="fill:#333" d="M 0 0 L 0 0 L 0 0 z"/></marker></defs></g><g style="opacity:1" class="edgePath" transform="translate(0, 0)"><path style="fill:none" marker-end="url(#arrowhead423)" d="M451.265625,94.10436011827566L476.265625,96.75L819.4296875,96.75L1202.830219072165,196.125" class="path"/><defs><marker id="arrowhead423" markerHeight="6" markerUnits="strokeWidth" markerWidth="8" orient="auto" refX="9" refY="5" viewBox="0 0 10 10"><path style="fill:#333" d="M 0 0 L 0 0 L 0 0 z"/></marker></defs></g><g style="opacity:1" class="edgePath" transform="translate(0, 0)"><path style="fill:none" marker-end="url(#arrowhead424)" d="M1411.859375,218L1436.859375,218L1461.859375,218L1486.859375,218" class="path"/><defs><marker id="arrowhead424" markerHeight="6" markerUnits="strokeWidth" markerWidth="8" orient="auto" refX="9" refY="5" viewBox="0 0 10 10"><path style="fill:#333" d="M 0 0 L 0 0 L 0 0 z"/></marker></defs></g></g><g class="edgeLabels"><g style="opacity:1" class="edgeLabel"><g class="label" transform="translate(0, 0) translate(0,0)"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;white-space:nowrap"><span class="edgeLabel"/></div></foreignObject></g></g><g style="opacity:1" class="edgeLabel"><g class="label" transform="translate(0, 0) translate(819.4296875,218) translate(-137.734375,-11.875)"><foreignObject width="275.469" height="23.75"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;white-space:nowrap"><span class="edgeLabel">Secures Channel-To-Bot Access</span></div></foreignObject></g></g><g style="opacity:1" class="edgeLabel"><g class="label" transform="translate(0, 0) translate(0,0)"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;white-space:nowrap"><span class="edgeLabel"/></div></foreignObject></g></g><g style="opacity:1" class="edgeLabel"><g class="label" transform="translate(0, 0) translate(819.4296875,96.75) translate(-318.1640625,-11.875)"><foreignObject width="636.328" height="23.75"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;white-space:nowrap"><span class="edgeLabel">OAuth Connection with AAD&apos;s client ID, client secret, tenant ID, scopes</span></div></foreignObject></g></g><g style="opacity:1" class="edgeLabel"><g class="label" transform="translate(0, 0) translate(0,0)"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;white-space:nowrap"><span class="edgeLabel"/></div></foreignObject></g></g></g><g class="nodes" transform="translate(0, 0)"><g style="opacity:1" id="ProtectedResource" class="node" transform="translate(1287.2265625,64.875)"><polygon points="10.938 0 204.484 0 215.422 -21.875 204.484 -43.75 10.938 -43.75 0 -21.875" class="label-container" transform="translate(-107.7109375,21.875)"/><g class="label"><g transform="translate(0,0) translate(-86.7734375,-11.875)"><foreignObject width="173.555" height="23.75"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;white-space:nowrap">Protected Resource</div></foreignObject></g></g></g><g style="opacity:1" id="AAD2" class="node" transform="translate(325.6640625,80.8125)"><rect width="251.203" height="43.75" x="-125.602" y="-21.875" class="label-container" rx="21.875" ry="21.875"/><g class="label"><g transform="translate(0,0) translate(-110.1328125,-11.875)"><foreignObject width="220.273" height="23.75"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;white-space:nowrap">AAD App Registration 2**</div></foreignObject></g></g></g><g style="opacity:1" id="AAD1" class="node" transform="translate(325.6640625,218)"><rect width="243.859" height="43.75" x="-121.93" y="-21.875" class="label-container" rx="21.875" ry="21.875"/><g class="label"><g transform="translate(0,0) translate(-106.4609375,-11.875)"><foreignObject width="212.93" height="23.75"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;white-space:nowrap">AAD App Registration 1*</div></foreignObject></g></g></g><g style="opacity:1" id="Channel" class="node" transform="translate(79.03125,218)"><rect width="92.063" height="43.75" x="-46.031" y="-21.875" class="label-container" rx="0" ry="0"/><g class="label"><g transform="translate(0,0) translate(-36.03125,-11.875)"><foreignObject width="72.07" height="23.75"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;white-space:nowrap">Channel</div></foreignObject></g></g></g><g style="opacity:1" id="BotChannelsRegistration" class="node" transform="translate(1287.2265625,218)"><rect width="249.266" height="43.75" x="-124.633" y="-21.875" class="label-container" rx="5" ry="5"/><g class="label"><g transform="translate(0,0) translate(-114.6328125,-11.875)"><foreignObject width="229.277" height="23.75"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;white-space:nowrap">Bot Channels Registration</div></foreignObject></g></g></g><g style="opacity:1" id="Bot" class="node" transform="translate(1511.84375,218)"><rect width="49.969" height="43.75" x="-24.984" y="-21.875" class="label-container" rx="5" ry="5"/><g class="label"><g transform="translate(0,0) translate(-14.984375,-11.875)"><foreignObject width="29.98" height="23.75"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;white-space:nowrap">Bot</div></foreignObject></g></g></g></g></g></g></svg>